"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}!function(){var OwO=function(){function OwO(option){var _this=this;_classCallCheck(this,OwO);var defaultOption={logo:"OwO表情",container:document.getElementsByClassName("OwO")[0],target:document.getElementsByTagName("textarea")[0],position:"down",width:"100%",maxHeight:"235px",api:"https://api.anotherhome.net/OwO/OwO.json"};for(var defaultKey in defaultOption)defaultOption.hasOwnProperty(defaultKey)&&!option.hasOwnProperty(defaultKey)&&(option[defaultKey]=defaultOption[defaultKey]);this.container=option.container,this.target=option.target,"up"===option.position&&this.container.classList.add("OwO-up");var xhr=new XMLHttpRequest;xhr.onreadystatechange=function(){4===xhr.readyState&&(xhr.status>=200&&xhr.status<300||304===xhr.status?(_this.odata=JSON.parse(xhr.responseText),_this.init(option)):console.log("OwO data request was unsuccessful: "+xhr.status))},xhr.open("get",option.api,!0),xhr.send(null)}return _createClass(OwO,[{key:"init",value:function init(option){var _this2=this;this.area=option.target,this.packages=Object.keys(this.odata);for(var html='\n            <div class="OwO-logo padder-v-sm"><span class="smile-icons"><svg viewBox="0 0 24 24" width="24" height="24" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" class="css-i6dzq1"><circle cx="12" cy="12" r="10"></circle><path d="M8 14s1.5 2 4 2 4-2 4-2"></path><line x1="9" y1="9" x2="9.01" y2="9"></line><line x1="15" y1="9" x2="15.01" y2="9"></line></svg></span><span class="OwOlogotext">'+option.logo+'</span></div>\n            <div class="OwO-body" style="width: '+option.width+'"><div class="OwO-title"><span>OwO</span></div>',i=0;i<this.packages.length;i++){html+='\n                <ul class="OwO-items OwO-'+this.odata[this.packages[i]].name+" OwO-items-"+this.odata[this.packages[i]].type+'" style="max-height: '+(parseInt(option.maxHeight)-53)+'px;">';for(var opackage=this.odata[this.packages[i]].container,_i=0;_i<opackage.length;_i++)"image"===this.odata[this.packages[i]].type?html+='\n                    <li class="OwO-item" title="'+opackage[_i].text+'" data-input="'+this.odata[this.packages[i]].name+":"+opackage[_i].icon+'"><img noGallery noAlt data-original="'+LocalConst.STATIC_PATH+"img/emotion/"+this.odata[this.packages[i]].name+"/"+opackage[_i].icon+'.png" src="" icon="'+opackage[_i].text+'"></li>':html+='\n                    <li class="OwO-item" title="'+opackage[_i].text+'">'+opackage[_i].icon+"</li>";html+="\n                </ul>"}html+='\n                <div class="OwO-bar">\n                    <ul class="OwO-packages">';for(var _i2=0;_i2<this.packages.length;_i2++)html+="\n                        <li><span>"+this.packages[_i2]+"</span></li>";html+="\n                    </ul>\n                </div>\n            </div>\n            ",this.container.innerHTML=html,this.logo=this.container.getElementsByClassName("OwO-logo")[0],this.logo.addEventListener("click",(function(){_this2.toggle()})),this.container.getElementsByClassName("OwO-body")[0].addEventListener("click",(function(e){var target=null,type=0;if(e.target.classList.contains("OwO-item")?target=e.target:e.target.parentNode.classList.contains("OwO-item")&&(target=e.target.parentNode),target){var startPos=_this2.area.selectionStart,endPos=_this2.area.selectionEnd,areaValue=_this2.area.value,insertContent;insertContent=target.dataset.hasOwnProperty("input")?" ::"+target.dataset.input+":: ":target.innerHTML,_this2.area.value=areaValue.slice(0,startPos)+insertContent+areaValue.slice(endPos),_this2.area.selectionStart=startPos+insertContent.length,_this2.area.selectionEnd=startPos+insertContent.length,_this2.area.focus(),_this2.toggle()}})),this.packagesEle=this.container.getElementsByClassName("OwO-packages")[0];for(var _loop=function _loop(_i3){var index;index=_i3,_this2.packagesEle.children[_i3].addEventListener("click",(function(){_this2.tab(index)}))},_i3=0;_i3<this.packagesEle.children.length;_i3++)_loop(_i3);this.tab(0)}},{key:"toggle",value:function toggle(){this.container.classList.contains("OwO-open")?this.container.classList.remove("OwO-open"):this.container.classList.add("OwO-open");var secret=document.getElementById("secret_comment");secret&&(null===secret.offsetParent?secret.style.display="block":secret.style.display="none");try{$("img").lazyload({effect:"fadeIn"})}catch(e){if(this.container.classList.contains("OwO-open")){var a=this.container.querySelectorAll(".OwO-items.OwO-items-show>li img");[].forEach.call(a,(function(a){var b=a.dataset.original;b&&(a.src=b,a.removeAttribute("data-src"))}))}}}},{key:"tab",value:function tab(index){var itemsShow=this.container.getElementsByClassName("OwO-items-show")[0];itemsShow&&itemsShow.classList.remove("OwO-items-show"),this.container.getElementsByClassName("OwO-items")[index].classList.add("OwO-items-show");var packageActive=this.container.getElementsByClassName("OwO-package-active")[0];packageActive&&packageActive.classList.remove("OwO-package-active"),this.packagesEle.getElementsByTagName("li")[index].classList.add("OwO-package-active");try{$("img").lazyload({effect:"fadeIn"})}catch(e){if(this.container.classList.contains("OwO-open")){var a=this.container.querySelectorAll(".OwO-items.OwO-items-show>li img");[].forEach.call(a,(function(a){var b=a.dataset.original;b&&(a.src=b,a.removeAttribute("data-original"))}))}}}}]),OwO}();"undefined"!=typeof module&&void 0!==module.exports?module.exports=OwO:window.OwO=OwO}();