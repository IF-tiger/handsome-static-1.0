var start_date="20210101",date=new Date,end_date=date.getFullYear()+(date.getMonth()>8?date.getMonth()+1:"0"+(date.getMonth()+1))+(date.getDate()>9?date.getDate():"0"+date.getDate()),access_token="121.b448dc22efd7cc8460e52d33a7bff4f4.YQZCgPGo7mFggzCIzE6fxUiSSTmbmnP-p5kUomT.Ov4Y_w",site_id="15982066",dataUrl="https://baidu-tongji-api-tau.vercel.app/api?access_token="+access_token+"&site_id="+site_id,metrics="pv_count",metricsName="pv_count"===metrics?"访问次数":"visitor_count"===metrics?"访客数":"",color="light"===document.documentElement.getAttribute("data-theme")?"#4c4948":"rgba(255,255,255,0.7)";function mapChart(){let script=document.createElement("script"),paramUrl;fetch(dataUrl+("&start_date="+start_date+"&end_date="+end_date+"&metrics="+metrics+"&method=visit/district/a")).then(data=>data.json()).then(data=>{let mapName=data.result.items[0],mapValue=data.result.items[1],mapArr=[],max=mapValue[0][0];for(let i=0;i<mapName.length;i++)mapArr.push({name:mapName[i][0].name,value:mapValue[i][0]});let mapArrJson=JSON.stringify(mapArr);script.innerHTML=`\n      var mapChart = echarts.init(document.getElementById('map-chart'), 'light');\n      var mapOption = {\n        title: {\n          text: '博客访问来源地图',\n          x: 'center',\n          textStyle: {\n            color: ''\n          }\n        },\n        tooltip: {\n          trigger: 'item'\n        },\n        visualMap: {\n          min: 0,\n          max: ,\n          left: 'left',\n          top: 'bottom',\n          text: ['高','低'],\n          color: ['#1E90FF', '#AAFAFA'],\n          textStyle: {\n            color: ''\n          },\n          calculable: true\n        },\n        series: [{\n          name: '',\n          type: 'map',\n          mapType: 'china',\n          showLegendSymbol: false,\n          label: {\n            emphasis: {\n              show: false\n            }\n          },\n          itemStyle: {\n            normal: {\n              areaColor: 'rgba(255, 255, 255, 0.1)',\n              borderColor: '#121212'\n            },\n            emphasis: {\n              areaColor: 'gold'\n            }\n          },\n          data: \n          }]\n        };\n      mapChart.setOption(mapOption);\n      window.addEventListener("resize", () => { \n        mapChart.resize();\n      });`,document.getElementById("map-chart").after(script)}).catch((function(error){console.log(error)}))}function trendsChart(){let script=document.createElement("script"),paramUrl;fetch(dataUrl+("&start_date="+start_date+"&end_date="+end_date+"&metrics="+metrics+"&method=trend/time/a&gran=month")).then(data=>data.json()).then(data=>{let monthArr=[],monthValueArr=[],monthName=data.result.items[0],monthValue=data.result.items[1];for(let i=Math.min(monthName.length,12)-1;i>=0;i--)monthArr.push(monthName[i][0].substring(0,7).replace("/","-")),"--"!==monthValue[i][0]?monthValueArr.push(monthValue[i][0]):monthValueArr.push(null);let monthArrJson=JSON.stringify(monthArr),monthValueArrJson=JSON.stringify(monthValueArr);script.innerHTML=`\n        var trendsChart = echarts.init(document.getElementById('trends-chart'), 'light');\n        var trendsOption = {\n          textStyle: {\n            color: ''\n          },\n          title: {\n            text: '博客访问统计图',\n            x: 'center',\n            textStyle: {\n              color: ''\n            }\n          },\n          tooltip: {\n            trigger: 'axis'\n          },\n          xAxis: {\n            name: '日期',\n            type: 'category',\n            axisTick: {\n              show: false\n            },\n            axisLine: {\n              show: true,\n              lineStyle: {\n                color: ''\n              }\n            },\n            data: \n          },\n          yAxis: {\n            name: '',\n            type: 'value',\n            splitLine: {\n              show: false\n            },\n            axisTick: {\n              show: false\n            },\n            axisLine: {\n              show: true,\n              lineStyle: {\n                color: ''\n              }\n            }\n          },\n          series: [{\n            name: '',\n            type: 'line',\n            smooth: true,\n            lineStyle: {\n                width: 0\n            },\n            showSymbol: false,\n            itemStyle: {\n              opacity: 1,\n              color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\n                offset: 0,\n                color: 'rgba(128, 255, 165)'\n              },\n              {\n                offset: 1,\n                color: 'rgba(1, 191, 236)'\n              }])\n            },\n            areaStyle: {\n              opacity: 1,\n              color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [{\n                offset: 0,\n                color: 'rgba(128, 255, 165)'\n              }, {\n                offset: 1,\n                color: 'rgba(1, 191, 236)'\n              }])\n            },\n            data: ,\n            markLine: {\n              data: [{\n                name: '平均值',\n                type: 'average'\n              }]\n            }\n          }]\n        };\n        trendsChart.setOption(trendsOption);\n        window.addEventListener("resize", () => { \n          trendsChart.resize();\n        });`,document.getElementById("trends-chart").after(script)}).catch((function(error){console.log(error)}))}function sourcesChart(){let script=document.createElement("script"),paramUrl;fetch(dataUrl+("&start_date="+start_date+"&end_date="+end_date+"&metrics="+metrics+"&method=source/all/a")).then(data=>data.json()).then(data=>{monthArr=[];let sourcesName=data.result.items[0],sourcesValue=data.result.items[1],sourcesArr=[];for(let i=0;i<sourcesName.length;i++)sourcesArr.push({name:sourcesName[i][0].name,value:sourcesValue[i][0]});let sourcesArrJson=JSON.stringify(sourcesArr);script.innerHTML=`\n        var sourcesChart = echarts.init(document.getElementById('sources-chart'), 'light');\n        var sourcesOption = {\n          textStyle: {\n            color: ''\n          },\n          title: {\n            text: '博客访问来源统计图',\n            x: 'center',\n            textStyle: {\n              color: ''\n            }\n          },\n          legend: {\n            top: 'bottom',\n            textStyle: {\n              color: ''\n            }\n          },\n          tooltip: {\n            trigger: 'item',\n            formatter: "{a} <br/>{b} : {c} ({d}%)"\n          },\n          series: [{\n            name: '',\n            type: 'pie',\n            radius: [30, 80],\n            center: ['50%', '50%'],\n            roseType: 'area',\n            label: {\n              formatter: "{b} : {c} ({d}%)"\n            },\n            data: ,\n            itemStyle: {\n              emphasis: {\n                shadowBlur: 10,\n                shadowOffsetX: 0,\n                shadowColor: 'rgba(255, 255, 255, 0.5)'\n              }\n            }\n          }]\n        };\n        sourcesChart.setOption(sourcesOption);\n        window.addEventListener("resize", () => { \n          sourcesChart.resize();\n        });`,document.getElementById("sources-chart").after(script)}).catch((function(error){console.log(error)}))}document.getElementById("map-chart")&&mapChart(),document.getElementById("trends-chart")&&trendsChart(),document.getElementById("sources-chart")&&sourcesChart();